version: "3"
services:
  user:
    build: ./users
  auth:
    build: ./auth
    environment:
      - USER_HOST=user:5040
      - SCOPE_HOST=scope:5040
      - PUB_KEY_PATH=/app.rsa.pub
      - PRI_KEY_PATH=/app.rsa
      - JWKS_PATH=/jwks.json
    ports:
      - 5040:5040
      - 5050:5050
      - 5060:5060
  scope:
    build: ./scope
  resource:
    build: ./resource
  mysql:
    image: mysql:5.7
    restart: always
    ports:
      - 3306:3306
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: users
      MYSQL_USER: users
      MYSQL_PASSWORD: users